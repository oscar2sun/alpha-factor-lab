---
name: buffett-analysis
description: 巴菲特视角的上市公司基本面深度分析。当用户提到"分析一家公司"、"看看XX值不值得投资"、"XX的基本面怎么样"、"帮我研究一下XX"、个股分析、价值投资分析、公司估值等需求时使用。支持A股、港股代码或公司名称。自动获取财报、估值、行业数据，按巴菲特投资框架出具完整分析报告。
---

# 巴菲特视角基本面分析

## 分析框架

巴菲特的投资决策框架——四大核心维度：

### 1. 🏰 护城河分析 (Economic Moat)
- **毛利率**：>40% 优秀，>60% 极强定价权
- **ROE**：连续>15% 是优质企业门槛，>20% 是护城河标志
- **ROIC**：>15% 说明资本配置效率高
- **应收账款周转**：越快说明议价能力越强

### 2. 📊 盈利质量 (Earnings Quality)
- **经营现金流/净利润**：>80% 说明利润是"真金白银"
- **自由现金流**：正且持续增长是好生意的标志
- **营收/利润增速**：关注稳定性而非单年爆发
- **扣非净利润 vs 净利润**：差距大说明非经常性损益多

### 3. 💰 财务健康 (Financial Health)
- **资产负债率**：因行业而异，但过高(>60%)需警惕
- **流动比率/速动比率**：>2/>1 为安全
- **有息负债**：越少越好，巴菲特偏爱低负债公司
- **货币资金/短期借款**：>1 说明现金充裕

### 4. 📐 估值合理性 (Valuation)
- **PE-TTM**：与历史分位、同行对比
- **PB**：结合ROE看（高ROE高PB合理）
- **自由现金流收益率**：FCF/市值，>5% 有吸引力
- **股息率**：巴菲特看重分红能力

## 执行流程

当用户要求分析一家公司时：

1. **运行数据采集脚本**获取全面财务数据
2. **读取 `references/analysis-template.md`** 获取分析报告模板
3. 结合数据和行业背景，按模板撰写深度分析

### Step 1: 数据采集

运行脚本（使用公司名或代码）：

```bash
PATH="/home/node/.local/bin:$PATH" python3 scripts/fetch_company_data.py "贵州茅台"
```

脚本输出 JSON 到 `/tmp/buffett_analysis_{code}.json`，包含：
- 公司基本信息、行业分类
- 最新利润表、资产负债表、现金流量表
- 核心财务指标（ROE/ROIC/毛利率等，含多期对比）
- 估值指标（PE/PB/PS/PCF）
- 实时行情、市值
- 十大股东
- 同行业公司列表（用于对比）

如需同行对比数据，对2-3家可比公司额外运行：
```bash
PATH="/home/node/.local/bin:$PATH" python3 scripts/fetch_company_data.py "五粮液"
```

### Step 2: 读取分析模板

```
read references/analysis-template.md
```

### Step 3: 撰写分析报告

结合采集数据 + 分析模板 + 以下原则撰写报告：

**巴菲特语言风格：**
- 用生活化比喻解释财务概念
- 适当引用巴菲特/芒格名言
- 给出明确观点，不做墙头草
- 永远提示风险

**分析深度要求：**
- 不只列数字，要解读数字背后的商业逻辑
- 结合行业竞争格局分析护城河
- 横向对比（vs 同行）+ 纵向对比（vs 自身历史）
- 最终给出清晰的投资价值判断

**输出格式：**
- 飞书/群聊用 bullet points，不用 markdown 表格
- 先给结论（一句话总结），再展开分析
- 控制在合理篇幅（不要写论文）
