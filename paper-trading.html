<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ† AIæŠ•èµ„ç«èµ› Â· ä¸‰å¤§æµæ´¾å¯¹å†³</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
:root {
  --bg: #0f1117; --card: #181b23; --border: #2a2d38;
  --text: #e2e4ea; --text2: #8b8fa3; --accent: #4f8cff;
  --green: #22c55e; --red: #ef4444; --yellow: #f59e0b; --purple: #a855f7;
  --quant: #4f8cff; --trader: #f59e0b; --value: #22c55e;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { background:var(--bg); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif; line-height:1.6; }
.container { max-width:1280px; margin:0 auto; padding:24px 16px; }
a { color:var(--accent); text-decoration:none; }
a:hover { text-decoration:underline; }

/* Header */
.header { text-align:center; padding:32px 0 16px; }
.header h1 { font-size:2rem; font-weight:700; }
.header .subtitle { color:var(--text2); font-size:0.9rem; margin-top:4px; }
.nav-links { margin-top:12px; }
.nav-links a { margin:0 8px; padding:6px 14px; border:1px solid var(--border); border-radius:8px; font-size:0.85rem; transition:all .2s; }
.nav-links a:hover, .nav-links a.active { border-color:var(--accent); background:rgba(79,140,255,.1); text-decoration:none; }

/* Leaderboard */
.leaderboard { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin:24px 0; }
.player-card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:20px; cursor:pointer; transition:all .2s; position:relative; overflow:hidden; }
.player-card:hover { border-color:var(--accent); transform:translateY(-2px); }
.player-card.active { border-color:var(--accent); box-shadow:0 0 20px rgba(79,140,255,.15); }
.player-card .rank { position:absolute; top:12px; right:16px; font-size:1.8rem; }
.player-card .emoji { font-size:2rem; margin-bottom:8px; display:block; }
.player-card .name { font-size:1.1rem; font-weight:700; }
.player-card .style { color:var(--text2); font-size:0.78rem; margin-top:2px; }
.player-card .return { font-size:1.8rem; font-weight:700; margin-top:12px; }
.player-card .return.green { color:var(--green); }
.player-card .return.red { color:var(--red); }
.player-card .return.neutral { color:var(--text2); }
.player-card .sub-stats { display:flex; gap:16px; margin-top:8px; font-size:0.82rem; color:var(--text2); }
.player-card .sub-stats span { display:flex; flex-direction:column; }
.player-card .sub-stats .label { font-size:0.7rem; }
.player-card .sub-stats .val { font-weight:600; color:var(--text); }

/* Section */
.section { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:24px; margin-bottom:20px; }
.section h2 { font-size:1.1rem; margin-bottom:16px; display:flex; align-items:center; gap:8px; }
.section h2 .dot { width:4px; height:18px; border-radius:2px; background:var(--accent); }

/* Tabs */
.tabs { display:flex; gap:8px; margin-bottom:20px; }
.tab-btn { background:var(--bg); border:1px solid var(--border); color:var(--text2); padding:8px 20px; border-radius:8px; cursor:pointer; font-size:0.85rem; transition:all .2s; }
.tab-btn:hover { border-color:var(--accent); color:var(--text); }
.tab-btn.active { background:var(--accent); border-color:var(--accent); color:#fff; }
.tab-content { display:none; }
.tab-content.active { display:block; }

/* Table */
table { width:100%; border-collapse:collapse; font-size:0.85rem; }
th { color:var(--text2); font-weight:500; text-align:left; padding:10px 8px; border-bottom:1px solid var(--border); }
td { padding:10px 8px; border-bottom:1px solid var(--border); }
tr:last-child td { border-bottom:none; }
.tag-buy { background:rgba(34,197,94,.15); color:var(--green); padding:2px 10px; border-radius:4px; font-size:0.8rem; }
.tag-sell { background:rgba(239,68,68,.15); color:var(--red); padding:2px 10px; border-radius:4px; font-size:0.8rem; }
.tag-hold { background:rgba(139,143,163,.15); color:var(--text2); padding:2px 10px; border-radius:4px; font-size:0.8rem; }

/* Stats comparison */
.stats-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(130px,1fr)); gap:10px; }
.stat-item { background:var(--bg); border:1px solid var(--border); border-radius:8px; padding:12px; text-align:center; }
.stat-item .label { font-size:0.75rem; color:var(--text2); }
.stat-item .values { margin-top:6px; display:flex; flex-direction:column; gap:2px; }
.stat-item .pv { font-size:0.82rem; display:flex; justify-content:space-between; }
.stat-item .pv .pname { color:var(--text2); }

/* Chart */
.chart-box { position:relative; height:380px; }

/* Decision timeline */
.timeline { max-height:500px; overflow-y:auto; }
.timeline-item { display:flex; gap:12px; padding:10px 0; border-bottom:1px solid var(--border); }
.timeline-item:last-child { border-bottom:none; }
.timeline-item .time { min-width:80px; color:var(--text2); font-size:0.8rem; }
.timeline-item .badge { min-width:24px; font-size:1.1rem; }
.timeline-item .content { flex:1; }
.timeline-item .content .title { font-weight:600; font-size:0.88rem; }
.timeline-item .content .detail { color:var(--text2); font-size:0.82rem; margin-top:2px; }
.timeline-item .action-tag { font-size:0.75rem; padding:1px 8px; border-radius:3px; margin-left:8px; }

/* Empty */
.empty { text-align:center; padding:48px 20px; color:var(--text2); }
.empty .icon { font-size:3rem; margin-bottom:12px; }

/* Footer */
.footer { text-align:center; padding:32px 0; color:var(--text2); font-size:0.8rem; line-height:1.8; }
.footer .warn { color:var(--yellow); font-weight:500; margin-bottom:8px; display:block; }

/* Responsive */
@media(max-width:768px) {
  .leaderboard { grid-template-columns:1fr; }
  .header h1 { font-size:1.4rem; }
  .chart-box { height:280px; }
}
</style>
</head>
<body>
<div class="container">

<!-- Header -->
<div class="header">
  <h1>ğŸ† AIæŠ•èµ„ç«èµ› Â· ä¸‰å¤§æµæ´¾å¯¹å†³</h1>
  <div class="subtitle" id="metaInfo"></div>
  <div class="nav-links">
    <a href="index.html">â† é¦–é¡µ</a>
    <a href="factor-backtest.html">å› å­å›æµ‹</a>
    <a href="paper-trading.html" class="active">æ¨¡æ‹Ÿç«èµ›</a>
    <a href="fundamental.html">åŸºæœ¬é¢åˆ†æ</a>
    <a href="technical.html">æŠ€æœ¯åˆ†æ</a>
  </div>
</div>

<!-- Leaderboard -->
<div class="leaderboard" id="leaderboard"></div>

<!-- NAV Chart -->
<div class="section">
  <h2><span class="dot"></span>å‡€å€¼æ›²çº¿å¯¹æ¯”</h2>
  <div class="chart-box" id="navChartWrap"></div>
</div>

<!-- Stats Comparison -->
<div class="section">
  <h2><span class="dot"></span>æ ¸å¿ƒæŒ‡æ ‡å¯¹æ¯”</h2>
  <div id="statsComparison"></div>
</div>

<!-- Player Detail Tabs -->
<div class="section">
  <h2><span class="dot"></span>é€‰æ‰‹è¯¦æƒ…</h2>
  <div class="tabs" id="playerTabs"></div>
  <div id="playerDetails"></div>
</div>

<!-- Today's Activity -->
<div class="section">
  <h2><span class="dot"></span>æœ€æ–°åŠ¨æ€</h2>
  <div class="timeline" id="activityTimeline"></div>
</div>

<!-- Footer -->
<div class="footer">
  <span class="warn">âš ï¸ é£é™©æç¤ºï¼šæœ¬é¡µé¢ä¸ºAIæ¨¡æ‹Ÿç«èµ›ï¼Œä¸åæ˜ çœŸå®äº¤æ˜“ï¼Œä»…ä¾›ç ”ç©¶å‚è€ƒ</span>
  è´¹ç‡: ä½£é‡‘ä¸‡ä¸‰(åŒå‘) | å°èŠ±ç¨ä¸‡äº”(ä»…å–å‡º) | è¿‡æˆ·è´¹åä¸‡åˆ†ä¹‹ä¸€ | æ¨¡æ‹Ÿæ»‘ç‚¹åƒä¸€<br>
  <span id="updateTime"></span><br>
  Powered by <a href="https://oscar2sun.github.io/alpha-factor-lab/">Alpha Factor Lab</a>
</div>

</div>

<script>
// ===== Data Loading =====
const PLAYER_COLORS = { quant: '#4f8cff', trader: '#f59e0b', value: '#22c55e' };
const PLAYER_IDS = ['quant', 'trader', 'value'];
const MEDALS = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];

let DATA = null;

async function loadData() {
  try {
    const resp = await fetch('paper-trading-data.json?v=' + Date.now());
    DATA = await resp.json();
    renderAll();
  } catch (e) {
    console.error('Failed to load data:', e);
    document.getElementById('leaderboard').innerHTML = '<div class="empty" style="grid-column:1/-1"><div class="icon">ğŸ“¡</div>æ•°æ®åŠ è½½å¤±è´¥<br><small>è¯·æ£€æŸ¥ paper-trading-data.json</small></div>';
  }
}

function fmt(n, d=2) { return n == null ? 'â€”' : Number(n).toFixed(d); }
function fmtMoney(n) { return n == null ? 'â€”' : 'Â¥' + Number(n).toLocaleString('zh-CN', {minimumFractionDigits:0, maximumFractionDigits:0}); }
function pctClass(v) { return v > 0.01 ? 'green' : v < -0.01 ? 'red' : 'neutral'; }

// ===== Render =====
function renderAll() {
  renderMeta();
  renderLeaderboard();
  renderNavChart();
  renderStatsComparison();
  renderPlayerTabs();
  renderActivityTimeline();
}

function renderMeta() {
  const m = DATA.meta;
  document.getElementById('metaInfo').textContent = 
    `èµ·å§‹æ—¥æœŸ: ${m.start_date} | åˆå§‹èµ„é‡‘: ${fmtMoney(m.initial_cash)}/äºº | åŸºå‡†: ${m.benchmark_name}`;
  document.getElementById('updateTime').textContent = `æœ€åæ›´æ–°: ${m.updated_at}`;
}

function renderLeaderboard() {
  const el = document.getElementById('leaderboard');
  const rankings = DATA.leaderboard.rankings;
  
  if (!rankings || rankings.length === 0) {
    // No rankings yet, show all players as equal
    el.innerHTML = PLAYER_IDS.map(pid => {
      const p = DATA.players[pid];
      return `
        <div class="player-card" data-player="${pid}" onclick="selectPlayer('${pid}')">
          <span class="emoji">${p.emoji}</span>
          <div class="name">${p.name}</div>
          <div class="style">${p.style}</div>
          <div class="return neutral">â€”</div>
          <div class="sub-stats">
            <span><span class="label">æ€»èµ„äº§</span><span class="val">${fmtMoney(p.portfolio.total_value)}</span></span>
            <span><span class="label">æŒä»“</span><span class="val">${Object.keys(p.portfolio.positions).length}åª</span></span>
          </div>
        </div>`;
    }).join('');
    return;
  }
  
  el.innerHTML = rankings.map((r, i) => {
    const p = DATA.players[r.player_id];
    const retPct = r.total_return_pct;
    return `
      <div class="player-card" data-player="${r.player_id}" onclick="selectPlayer('${r.player_id}')" style="border-top:3px solid ${PLAYER_COLORS[r.player_id]}">
        <span class="rank">${MEDALS[i] || '#'+(i+1)}</span>
        <span class="emoji">${r.emoji}</span>
        <div class="name">${r.name}</div>
        <div class="style">${p.style}</div>
        <div class="return ${pctClass(retPct)}">${retPct >= 0 ? '+' : ''}${fmt(retPct)}%</div>
        <div class="sub-stats">
          <span><span class="label">Sharpe</span><span class="val">${fmt(r.sharpe_ratio)}</span></span>
          <span><span class="label">å›æ’¤</span><span class="val">${fmt(r.max_drawdown_pct)}%</span></span>
          <span><span class="label">äº¤æ˜“</span><span class="val">${r.total_trades}ç¬”</span></span>
        </div>
      </div>`;
  }).join('');
}

function renderNavChart() {
  const wrap = document.getElementById('navChartWrap');
  const hasData = PLAYER_IDS.some(pid => DATA.players[pid].nav_history.dates.length > 0);
  
  if (!hasData) {
    wrap.innerHTML = '<div class="empty"><div class="icon">ğŸ“ˆ</div>ç«èµ›å°šæœªå¼€å§‹<br><small>é¦–ä¸ªäº¤æ˜“æ—¥åå°†æ˜¾ç¤ºå‡€å€¼æ›²çº¿</small></div>';
    return;
  }
  
  wrap.innerHTML = '<canvas id="navChart"></canvas>';
  const datasets = [];
  
  PLAYER_IDS.forEach(pid => {
    const p = DATA.players[pid];
    if (p.nav_history.dates.length > 0) {
      datasets.push({
        label: p.name,
        data: p.nav_history.nav,
        borderColor: PLAYER_COLORS[pid],
        backgroundColor: 'transparent',
        tension: 0.3,
        pointRadius: p.nav_history.nav.length > 30 ? 0 : 3,
        borderWidth: 2.5
      });
    }
  });
  
  // Benchmark
  if (DATA.benchmark.dates.length > 0) {
    datasets.push({
      label: DATA.meta.benchmark_name,
      data: DATA.benchmark.nav,
      borderColor: '#8b8fa3',
      borderDash: [5, 3],
      backgroundColor: 'transparent',
      tension: 0.3,
      pointRadius: 0,
      borderWidth: 1.5
    });
  }
  
  const labels = DATA.benchmark.dates.length > 0 ? DATA.benchmark.dates :
    PLAYER_IDS.reduce((best, pid) => {
      const d = DATA.players[pid].nav_history.dates;
      return d.length > best.length ? d : best;
    }, []);
  
  new Chart(document.getElementById('navChart'), {
    type: 'line',
    data: { labels, datasets },
    options: {
      responsive: true, maintainAspectRatio: false,
      interaction: { mode: 'index', intersect: false },
      plugins: {
        legend: { labels: { color: '#8b8fa3', font: { size: 12 } } },
        tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(4) } }
      },
      scales: {
        x: { ticks: { color: '#8b8fa3', maxTicksLimit: 12 }, grid: { color: 'rgba(255,255,255,.05)' } },
        y: { ticks: { color: '#8b8fa3' }, grid: { color: 'rgba(255,255,255,.05)' } }
      }
    }
  });
}

function renderStatsComparison() {
  const el = document.getElementById('statsComparison');
  const metrics = [
    { key: 'total_return_pct', label: 'ç´¯è®¡æ”¶ç›Š', suffix: '%', signed: true },
    { key: 'annualized_return_pct', label: 'å¹´åŒ–æ”¶ç›Š', suffix: '%', signed: true },
    { key: 'max_drawdown_pct', label: 'æœ€å¤§å›æ’¤', suffix: '%' },
    { key: 'sharpe_ratio', label: 'Sharpe' },
    { key: 'calmar_ratio', label: 'Calmar' },
    { key: 'win_rate', label: 'èƒœç‡', suffix: '%' },
    { key: 'total_trades', label: 'æ€»äº¤æ˜“', suffix: 'ç¬”', isInt: true },
    { key: 'total_fees', label: 'ç´¯è®¡è´¹ç”¨', isMoney: true }
  ];
  
  el.innerHTML = '<div class="stats-grid">' + metrics.map(m => {
    const values = PLAYER_IDS.map(pid => {
      const p = DATA.players[pid];
      const v = p.stats[m.key] || 0;
      let display;
      if (m.isMoney) display = fmtMoney(v);
      else if (m.isInt) display = v + (m.suffix || '');
      else display = (m.signed && v > 0 ? '+' : '') + fmt(v) + (m.suffix || '');
      return `<div class="pv"><span class="pname">${p.emoji}</span><span style="color:${PLAYER_COLORS[pid]}">${display}</span></div>`;
    }).join('');
    return `<div class="stat-item"><div class="label">${m.label}</div><div class="values">${values}</div></div>`;
  }).join('') + '</div>';
}

// ===== Player Detail =====
let selectedPlayer = 'quant';

function selectPlayer(pid) {
  selectedPlayer = pid;
  document.querySelectorAll('.player-card').forEach(c => c.classList.remove('active'));
  document.querySelector(`.player-card[data-player="${pid}"]`)?.classList.add('active');
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.dataset.player === pid));
  renderPlayerDetail(pid);
}

function renderPlayerTabs() {
  const el = document.getElementById('playerTabs');
  el.innerHTML = PLAYER_IDS.map(pid => {
    const p = DATA.players[pid];
    return `<button class="tab-btn ${pid === selectedPlayer ? 'active' : ''}" data-player="${pid}" onclick="selectPlayer('${pid}')">${p.emoji} ${p.name}</button>`;
  }).join('');
  renderPlayerDetail(selectedPlayer);
}

function renderPlayerDetail(pid) {
  const el = document.getElementById('playerDetails');
  const p = DATA.players[pid];
  const positions = Object.values(p.portfolio.positions);
  const trades = (p.trades || []).slice().reverse().slice(0, 20);
  const decisions = (p.decisions || []).slice().reverse().slice(0, 15);
  const rebalances = (p.rebalances || []).slice().reverse().slice(0, 10);
  
  // Holdings
  let holdingsHtml;
  if (positions.length === 0) {
    holdingsHtml = '<div class="empty"><div class="icon">ğŸ“‹</div>ç©ºä»“ä¸­<br><small>æš‚æ— æŒä»“</small></div>';
  } else {
    holdingsHtml = `<div style="overflow-x:auto"><table>
      <thead><tr><th>ä»£ç </th><th>åç§°</th><th>æŒè‚¡</th><th>æˆæœ¬</th><th>ç°ä»·</th><th>å¸‚å€¼</th><th>ç›ˆäº</th></tr></thead>
      <tbody>${positions.map(pos => `<tr>
        <td>${pos.code}</td><td>${pos.name}</td><td>${pos.volume}</td>
        <td>Â¥${fmt(pos.avg_cost)}</td><td>Â¥${fmt(pos.current_price)}</td>
        <td>${fmtMoney(pos.market_value)}</td>
        <td style="color:${pos.pnl_pct >= 0 ? 'var(--green)' : 'var(--red)'}">${pos.pnl_pct >= 0 ? '+' : ''}${fmt(pos.pnl_pct)}%</td>
      </tr>`).join('')}</tbody></table></div>`;
  }
  
  // Trades
  let tradesHtml;
  if (trades.length === 0) {
    tradesHtml = '<div class="empty"><div class="icon">ğŸ“</div>æš‚æ— äº¤æ˜“è®°å½•</div>';
  } else {
    tradesHtml = `<div style="overflow-x:auto"><table>
      <thead><tr><th>æ—¥æœŸ</th><th>ä»£ç </th><th>åç§°</th><th>æ–¹å‘</th><th>ä»·æ ¼</th><th>æ•°é‡</th><th>é‡‘é¢</th><th>åŸå› </th></tr></thead>
      <tbody>${trades.map(t => `<tr>
        <td>${t.date}</td><td>${t.code}</td><td>${t.name}</td>
        <td><span class="tag-${t.direction}">${t.direction === 'buy' ? 'ä¹°å…¥' : 'å–å‡º'}</span></td>
        <td>Â¥${fmt(t.price)}</td><td>${t.volume}</td><td>${fmtMoney(t.amount)}</td>
        <td style="color:var(--text2);font-size:0.8rem;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${t.reason || ''}">${t.reason || 'â€”'}</td>
      </tr>`).join('')}</tbody></table></div>`;
  }
  
  // Decisions
  let decisionsHtml;
  if (decisions.length === 0) {
    decisionsHtml = '<div class="empty"><div class="icon">ğŸ§ </div>æš‚æ— å†³ç­–æ—¥å¿—</div>';
  } else {
    decisionsHtml = '<div class="timeline">' + decisions.map(d => {
      const actionTag = d.action === 'buy' ? '<span class="action-tag tag-buy">ä¹°å…¥</span>' :
                        d.action === 'sell' ? '<span class="action-tag tag-sell">å–å‡º</span>' :
                        d.action === 'rebalance' ? '<span class="action-tag" style="background:rgba(79,140,255,.15);color:var(--accent)">è°ƒä»“</span>' :
                        '<span class="action-tag tag-hold">æŒä»“</span>';
      return `<div class="timeline-item">
        <div class="time">${d.date}<br>${d.time || ''}</div>
        <div class="content"><div class="title">${d.summary}${actionTag}</div>${d.detail ? `<div class="detail">${d.detail}</div>` : ''}</div>
      </div>`;
    }).join('') + '</div>';
  }
  
  // Cash info
  const cashInfo = `<div style="display:flex;gap:16px;margin-bottom:16px;flex-wrap:wrap">
    <div style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:12px 16px">
      <span style="color:var(--text2);font-size:0.82rem">å¯ç”¨èµ„é‡‘</span><br>
      <span style="font-size:1.2rem;font-weight:700">${fmtMoney(p.portfolio.cash)}</span>
    </div>
    <div style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:12px 16px">
      <span style="color:var(--text2);font-size:0.82rem">æ€»èµ„äº§</span><br>
      <span style="font-size:1.2rem;font-weight:700">${fmtMoney(p.portfolio.total_value)}</span>
    </div>
    <div style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:12px 16px">
      <span style="color:var(--text2);font-size:0.82rem">æŒä»“æ•°</span><br>
      <span style="font-size:1.2rem;font-weight:700">${positions.length}åª</span>
    </div>
  </div>`;
  
  el.innerHTML = `
    ${cashInfo}
    <h3 style="font-size:0.95rem;margin:16px 0 8px;color:var(--text2)">ğŸ“‹ å½“å‰æŒä»“</h3>
    ${holdingsHtml}
    <h3 style="font-size:0.95rem;margin:24px 0 8px;color:var(--text2)">ğŸ“ äº¤æ˜“è®°å½• <small style="color:var(--text2)">(æœ€è¿‘20ç¬”)</small></h3>
    ${tradesHtml}
    <h3 style="font-size:0.95rem;margin:24px 0 8px;color:var(--text2)">ğŸ§  å†³ç­–æ—¥å¿— <small style="color:var(--text2)">(æœ€è¿‘15æ¡)</small></h3>
    ${decisionsHtml}
  `;
}

// ===== Activity Timeline =====
function renderActivityTimeline() {
  const el = document.getElementById('activityTimeline');
  
  // Merge all decisions from all players, sort by date desc
  let allDecisions = [];
  PLAYER_IDS.forEach(pid => {
    const p = DATA.players[pid];
    (p.decisions || []).forEach(d => {
      allDecisions.push({ ...d, player_id: pid, player_emoji: p.emoji, player_name: p.name });
    });
  });
  
  allDecisions.sort((a, b) => {
    const da = a.date + (a.time || '');
    const db = b.date + (b.time || '');
    return db.localeCompare(da);
  });
  
  const recent = allDecisions.slice(0, 20);
  
  if (recent.length === 0) {
    el.innerHTML = '<div class="empty"><div class="icon">ğŸ“¡</div>ç«èµ›å°šæœªå¼€å§‹<br><small>é€‰æ‰‹å¼€å§‹è¡ŒåŠ¨åå°†åœ¨æ­¤å±•ç¤ºåŠ¨æ€</small></div>';
    return;
  }
  
  el.innerHTML = recent.map(d => {
    const actionColors = { buy: 'var(--green)', sell: 'var(--red)', rebalance: 'var(--accent)', hold: 'var(--text2)' };
    const actionText = { buy: 'ä¹°å…¥', sell: 'å–å‡º', rebalance: 'è°ƒä»“', hold: 'è§‚æœ›' };
    return `<div class="timeline-item">
      <div class="time">${d.date}<br>${d.time || ''}</div>
      <div class="badge">${d.player_emoji}</div>
      <div class="content">
        <div class="title">${d.player_name}: ${d.summary}
          <span style="color:${actionColors[d.action] || 'var(--text2)'};font-size:0.8rem;margin-left:6px">[${actionText[d.action] || d.action}]</span>
        </div>
        ${d.detail ? `<div class="detail">${d.detail}</div>` : ''}
      </div>
    </div>`;
  }).join('');
}

// ===== Init =====
loadData();
</script>
</body>
</html>
